<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="dbdf1aa3-9c93-4e05-9a7e-ed231d923c89" activeEnvironment="Default" name="Employee API" resourceRoot="${projectDir}" soapui-version="5.7.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="bc9faa4f-30f4-47fb-a317-b182c81e9a69" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="Employee" path="/api/v1/employee" id="65c1e3b4-918b-4b4e-be52-08b77ba0887f"><con:settings/><con:parameters/><con:method name="Employee 1" id="652077f1-776e-479e-9d34-8d986842dc55" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>201</con:status><con:params/><con:element xmlns:emp="https://mindtree-emp.azurewebsites.net/api/v1/employee">emp:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="POST" id="dc2ec774-9bc7-4c09-8cb7-24980f490a80" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "c4",
  "id": 1000,
  "name": "praveen",
  "yearOfJoining": 2021
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employee</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="6d64bc36-1e12-4969-ba2c-02809dc55bfd" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="Employees" path="/api/v1/employees/{id}" id="42ae72be-f52e-4c86-9f97-f436b60a24f5"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Employees 1" id="1d5cc3c2-91f0-4de4-be65-92490c201ef5" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>202</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/1000">ns:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/1000">ns:Fault</con:element></con:representation><con:request name="GET" id="33b1a5d5-1286-426d-b738-8d4801a16fae" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="1000" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="6b674da2-825f-4eb5-ba3a-52f3db821731" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="5" path="/api/v1/employees/{id}" id="2c71835b-f157-4ab2-a9be-d9547b12fd11"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="5 1" id="7e451c74-db90-4756-8fef-7dc5b5b20458" method="PUT"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>202</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/5">ns:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/5">ns:Fault</con:element></con:representation><con:request name="PUT" id="2c5ad719-0cae-4c9d-a30e-aeef9ac36f37" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "string",
  "name": "pra",
  "yearOfJoining": 0
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/5</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="5" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="e4a43dd7-28bc-4a1f-a99c-9872a6f67328" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="1000" path="/api/v1/employees/{id}" id="4af51188-7331-4de4-8f35-1179312b5594"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="1000 1" id="4a9ec43a-c9bf-4b48-aaba-8b9c522d2a0f" method="DELETE"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 410</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/10001000">ns:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="DELETE" id="7da945dd-3d38-482f-b33d-a97cfe2d19ef" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="1080460" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="70636eeb-b60f-403e-a55d-07c32ba76e4d" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="1d51d163-014b-4914-915a-6f242ca58740" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="POST Request" id="b4506a94-b5d9-4823-8d4a-2306642b3efb"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employee" methodName="Employee 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="POST Request" id="dc2ec774-9bc7-4c09-8cb7-24980f490a80" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "${#TestSuite#compitency}",
  "id": "${#TestSuite#id}",
  "name": "${#TestSuite#name}",
  "yearOfJoining": "${#TestSuite#yearOfJoining}"
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employee</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="GET Request" id="5db17d03-837f-43ac-9b7b-523254ebffb2"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="Employees 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GET Request" id="33b1a5d5-1286-426d-b738-8d4801a16fae" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="PUT Request" id="08b6d07e-71bf-411c-b39f-98311c3ce437"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="5 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="PUT Request" id="2c5ad719-0cae-4c9d-a30e-aeef9ac36f37" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "${#TestSuite#compitency}",
  "name": "${#TestSuite#name}",
  "yearOfJoining": "${#TestSuite#yearOfJoining}"
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/5</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="DELETE Request" id="4a9e97cc-0732-4594-a510-08223a8f3546"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="1000 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="DELETE Request" id="7da945dd-3d38-482f-b33d-a97cfe2d19ef" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/10001000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="21c6b9d4-2727-4508-bf1e-393e79c0788e"><con:settings/><con:config><script><![CDATA[import jxl.*
import jxl.write.*
import groovy.json.JsonSlurper

//Excel Data For POST
Workbook work = Workbook.getWorkbook(new File("C:\\Users\\prati\\OneDrive\\Desktop\\Employee Data.xls"));
Sheet data = work.getSheet(0)
String compitency = data.getCell(0,1).getContents()
String id = data.getCell(1,1).getContents()
String name = data.getCell(2,1).getContents()
String yearOfJoining = data.getCell(3,1).getContents()

//Post
testRunner.testCase.testSuite.setPropertyValue("compitency",compitency)
testRunner.testCase.testSuite.setPropertyValue("id",id)
testRunner.testCase.testSuite.setPropertyValue("name",name)
testRunner.testCase.testSuite.setPropertyValue("yearOfJoining",yearOfJoining)
def tCase = testRunner.testCase.testSuite.testCases["TestCase 1"]
def getIdTestStep = tCase.testSteps["POST Request"]
log.info"Running POST Request"
def restRequest=getIdTestStep.run(testRunner,context)
def responseJson =getIdTestStep.testRequest.response.responseContent
JsonSlurper slurper = new JsonSlurper()
def parsedJson = slurper.parseText(responseJson)
log.info(responseJson)
if(parsedJson.httpStatus.equals("CREATED")){
	log.info"POST Request has run successfully"
	assert true	
}else{
	log.info"POST was unsuccessful"
	assert false
}

//Get
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep1 = tCase.testSteps["GET Request"]
log.info"Running GET Request"
def restRequest1=getIdTestStep1.run(testRunner,context)
def responseJson1 =getIdTestStep1.testRequest.response.responseContent
def parsedJson1 = slurper.parseText(responseJson1)
log.info(responseJson1)
if(parsedJson1.httpStatus.equals("ACCEPTED")){
	log.info"GET Request has run successfully"
	assert true
}
log.info(compitency)
if(parsedJson1.body.name.equals(name) && parsedJson1.body.compitency.equals(compitency) && parsedJson1.body.yearOfJoining.equals(yearOfJoining.toInteger())){
	log.info"New Employee was added"
	assert true
}else{
	log.info"Employee was not added"
	assert false
}
//Excel Data For PUT 
compitancy = data.getCell(0,2).getContents()
id = data.getCell(1,2).getContents()
name = data.getCell(2,2).getContents()
yearOfJoining = data.getCell(3,2).getContents()

//Put
testRunner.testCase.testSuite.setPropertyValue("compitency",compitency)
testRunner.testCase.testSuite.setPropertyValue("id",id)
testRunner.testCase.testSuite.setPropertyValue("name",name)
testRunner.testCase.testSuite.setPropertyValue("yearOfJoining",yearOfJoining)
log.info"Running PUT Request"
def getIdTestStep2 = tCase.testSteps["PUT Request"]
def restRequest2=getIdTestStep2.run(testRunner,context)
def responseJson2 =getIdTestStep2.testRequest.response.responseContent
def parsedJson2 = slurper.parseText(responseJson2)
log.info(responseJson2)
if(parsedJson2.httpStatus.equals("UPDATED")){
	log.info"PUT Request has run successfully"
	assert true	
}else{
	log.info"PUT was unsuccessful"
	assert false
}

//Get
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep3 = tCase.testSteps["GET Request"]
def restRequest3=getIdTestStep3.run(testRunner,context)
log.info"Running GET Request"
def responseJson3 =getIdTestStep3.testRequest.response.responseContent
def parsedJson3 = slurper.parseText(responseJson3)
log.info(responseJson3)
if(parsedJson3.httpStatus.equals("ACCEPTED")){
	log.info"GET Request has run successfully"
	assert true
}
if(parsedJson3.body.name.equals(name) && parsedJson3.body.compitency.equals(compitency) && parsedJson3.body.yearOfJoining.equals(yearOfJoining.toInteger())){
	log.info"Employee was Updated"
	assert true
}else{
	log.info"Employee was not Updated"
	assert false
}

//Delete
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep4 = tCase.testSteps["DELETE Request"]
log.info"Running DELETE Request"
def restRequest4=getIdTestStep4.run(testRunner,context)
def responseJson4 =getIdTestStep4.testRequest.response.responseContent
def parsedJson4 = slurper.parseText(responseJson4)
log.info(responseJson4)
if(parsedJson4.httpStatus.equals("DELETED")){
	log.info"DELETE Request has run successfully"
	assert true	
}else{
	log.info"DELETE was unsuccessful"
	assert false
}

//Get
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep5 = tCase.testSteps["GET Request"]
log.info"Running GET Request"
def restRequest5=getIdTestStep5.run(testRunner,context)
def responseJson5 =getIdTestStep5.testRequest.response.responseContent
def parsedJson5 = slurper.parseText(responseJson5)
log.info(responseJson5)
if(parsedJson5.status.equals(500)){
	log.info"GET Request has run successfully"
	log.info"Employee was deleted"
	assert true
}else{
	log.info"Employee was not deleted"
	assert false
}
work.close()]]></script></con:config></con:testStep><con:properties/></con:testCase><con:properties><con:property><con:name>compitency</con:name><con:value>C1</con:value></con:property><con:property><con:name>id</con:name><con:value>1080460</con:value></con:property><con:property><con:name>name</con:name><con:value>Eswar Kumar</con:value></con:property><con:property><con:name>yearOfJoining</con:name><con:value>2025</con:value></con:property></con:properties></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/></con:soapui-project>